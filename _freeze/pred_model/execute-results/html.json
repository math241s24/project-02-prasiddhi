{
  "hash": "11ee2457e1896f43658987f487a21022",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Predictive Modeling: Supervised Learning\"\noutput: pdf_document\ndate: \"2024-04-24\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tmap)\nlibrary(sf)\nlibrary(tidyverse)\nlibrary(rpart)\nlibrary(tidymodels)\nlibrary(randomForest)\nlibrary(caret)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"World\")\n\ncountries <- World %>%\n  st_drop_geometry() %>%\n  select(name, continent) %>%\n  filter(continent %in% c(\"North America\", \"South America\", \"Asia\", \"Africa\")) %>%  \n  rename(\"Country\" = name) %>%\n  mutate(continent = as.character(continent)) %>% # So I can assign Mauritius a continent\n  mutate(Country = as.character(Country))\n\nmerged <- read_csv(\"data/merged_data_cleaned.csv\") %>%\n  rename(\"Country\" = Country.of.Origin,\n         \"Total\" = Total.Cup.Points) %>%\n  mutate(Country = recode(Country,\n                                      \"Cote d?Ivoire\" = \"Cote d'Ivoire\",\n                                      \"Tanzania, United Republic Of\" = \"Tanzania\",\n                                      \"Laos\" = \"Lao PDR\",\n                                      \"United States (Puerto Rico)\" = \"Puerto Rico\",\n                                      \"United States (Hawaii)\" = \"United States\")) %>% \n  filter(!is.na(Country)) %>%\n  group_by(Country) %>%\n  mutate(Country = as.character(Country))\n\nboth_world <- merge(countries, merged, \n                    by.x = \"Country\", by.y = \"Country\", \n                    all.x = TRUE, all.y = TRUE) \n\ncoffee <- both_world %>%\n  filter(complete.cases(Species, Acidity, Aroma, Flavor, Sweetness, Total)) %>%\n  mutate(continent = ifelse(Country == \"Mauritius\", \"Africa\", continent)) %>%\n  filter(continent %in% c(\"North America\", \"South America\", \"Asia\", \"Africa\")) %>%\n  mutate(Species = as.factor(Species))\n\ncoffee$continent <- factor(coffee$continent) # Changing it back to factor\n\nclass(coffee$continent)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"factor\"\n```\n\n\n:::\n\n```{.r .cell-code}\n#There was one observation for Oceania so i filtered to only include the other four continents present in the data. I had to assign Mauritius a continent since it's not in the world data set, requiring me to change the continent variable from factor, to character, back to factor.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee_parts <- coffee %>%\n  initial_split(prop = 0.8)\n\ntrain <- coffee_parts %>%\n  training()\n\ntest <- coffee_parts %>%\n  testing()\n\nnew_test <- test %>%\n  select(-continent)\n\nnew_train <- train %>%\n  select(-continent)\n\ntrain %>%\n  count(continent) %>%\n  mutate(pct = n / nrow(train))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      continent   n       pct\n1        Africa 130 0.1216090\n2          Asia 142 0.1328344\n3 North America 533 0.4985968\n4 South America 264 0.2469598\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nform_all <- as.formula(\n  \"continent ~ Sweetness + Acidity + Total + Flavor + Aroma + Species\"\n)\n\nmod_tree_all <- decision_tree(mode = \"classification\") %>%\n  set_engine(\"rpart\") %>%\n  fit(form_all, data = train)\nmod_tree_all\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nparsnip model object\n\nn= 1069 \n\nnode), split, n, loss, yval, (yprob)\n      * denotes terminal node\n\n 1) root 1069 536 North America (0.12160898 0.13283442 0.49859682 0.24695978)  \n   2) Total>=80.29 890 495 North America (0.14382022 0.13370787 0.44382022 0.27865169)  \n     4) Acidity>=7.875 126  69 North America (0.34126984 0.08730159 0.45238095 0.11904762)  \n       8) Total>=84.335 89  49 Africa (0.44943820 0.06741573 0.34831461 0.13483146) *\n       9) Total< 84.335 37  11 North America (0.08108108 0.13513514 0.70270270 0.08108108) *\n     5) Acidity< 7.875 764 426 North America (0.11125654 0.14136126 0.44240838 0.30497382)  \n      10) Total< 82.875 431 213 North America (0.10904872 0.15777262 0.50580046 0.22737819)  \n        20) Acidity>=7.125 409 194 North America (0.11246944 0.14669927 0.52567237 0.21515892) *\n        21) Acidity< 7.125 22  12 South America (0.04545455 0.36363636 0.13636364 0.45454545) *\n      11) Total>=82.875 333 198 South America (0.11411411 0.12012012 0.36036036 0.40540541)  \n        22) Acidity>=7.605 202 120 North America (0.13861386 0.09900990 0.40594059 0.35643564)  \n          44) Total>=83.4 153  95 South America (0.16339869 0.10457516 0.35294118 0.37908497)  \n            88) Flavor>=7.71 101  62 North America (0.19801980 0.12871287 0.38613861 0.28712871) *\n            89) Flavor< 7.71 52  23 South America (0.09615385 0.05769231 0.28846154 0.55769231) *\n          45) Total< 83.4 49  21 North America (0.06122449 0.08163265 0.57142857 0.28571429) *\n        23) Acidity< 7.605 131  68 South America (0.07633588 0.15267176 0.29007634 0.48091603) *\n   3) Total< 80.29 179  41 North America (0.01117318 0.12849162 0.77094972 0.08938547) *\n```\n\n\n:::\n\n```{.r .cell-code}\nprintcp(mod_tree_all$fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nClassification tree:\nrpart::rpart(formula = continent ~ Sweetness + Acidity + Total + \n    Flavor + Aroma + Species, data = data)\n\nVariables actually used in tree construction:\n[1] Acidity Flavor  Total  \n\nRoot node error: 536/1069 = 0.5014\n\nn= 1069 \n\n        CP nsplit rel error  xerror     xstd\n1 0.011194      0   1.00000 1.00000 0.030499\n2 0.010000      8   0.89739 0.99627 0.030500\n```\n\n\n:::\n\n```{.r .cell-code}\npred_all <- train %>%\n  select(continent) %>%\n  bind_cols(\n    predict(mod_tree_all, new_data = train, type = \"class\")\n  ) %>%\n  rename(continent_dtree = .pred_class)\npred_all\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         continent continent_dtree\n1    North America   North America\n2    North America   North America\n3             Asia   North America\n4    South America   South America\n5    North America   North America\n6           Africa   North America\n7             Asia   North America\n8    South America   South America\n9    North America   North America\n10   North America   North America\n11   South America   South America\n12          Africa   North America\n13   South America   North America\n14            Asia   North America\n15            Asia   North America\n16   North America   North America\n17   South America   North America\n18          Africa   North America\n19   North America   North America\n20   North America   North America\n21   North America   North America\n22   North America   North America\n23   North America   North America\n24   North America   North America\n25            Asia   North America\n26   South America   North America\n27   North America   North America\n28   South America   South America\n29   North America   South America\n30          Africa   North America\n31   North America   North America\n32   South America   South America\n33   South America   North America\n34   North America   North America\n35   North America   North America\n36   South America   South America\n37            Asia   South America\n38   North America   North America\n39            Asia   North America\n40   North America   North America\n41          Africa          Africa\n42   South America   North America\n43   North America   North America\n44   North America   South America\n45   North America   North America\n46   North America   North America\n47   South America   North America\n48   North America   North America\n49   North America   North America\n50   South America          Africa\n51   North America   South America\n52          Africa          Africa\n53   North America   North America\n54   North America   North America\n55   South America   North America\n56   North America   South America\n57   North America   South America\n58   North America   North America\n59   North America   North America\n60            Asia   North America\n61   North America   North America\n62   North America   North America\n63   North America   North America\n64   North America   North America\n65   North America   North America\n66            Asia   South America\n67   South America   North America\n68   North America   North America\n69   North America   North America\n70   North America   North America\n71   North America   North America\n72            Asia   North America\n73   North America   North America\n74            Asia   North America\n75            Asia          Africa\n76   North America   North America\n77   North America   North America\n78            Asia   North America\n79   South America   North America\n80          Africa   North America\n81          Africa          Africa\n82   South America   North America\n83   North America   North America\n84          Africa   North America\n85          Africa   North America\n86          Africa   North America\n87   North America   North America\n88          Africa   North America\n89   North America   North America\n90   North America   North America\n91   North America   North America\n92   North America   North America\n93          Africa   North America\n94   North America   South America\n95   North America   South America\n96   South America   South America\n97   North America          Africa\n98   North America   South America\n99   North America   South America\n100  North America   North America\n101  North America   North America\n102  North America   North America\n103         Africa   North America\n104  North America   North America\n105  South America   North America\n106  South America   North America\n107  North America   North America\n108           Asia   South America\n109           Asia   North America\n110  North America   North America\n111           Asia   North America\n112  North America   North America\n113  North America   North America\n114  South America   North America\n115  North America   North America\n116  North America   North America\n117         Africa   South America\n118  North America   North America\n119  South America   North America\n120  South America   North America\n121  North America   North America\n122  South America   South America\n123  South America   North America\n124  South America   North America\n125  North America   North America\n126           Asia   North America\n127           Asia   North America\n128  North America   North America\n129  South America   South America\n130  North America   South America\n131           Asia   North America\n132           Asia   North America\n133  North America   North America\n134  North America   North America\n135           Asia   North America\n136  North America   North America\n137  North America   North America\n138           Asia   North America\n139  North America   North America\n140         Africa   North America\n141           Asia   North America\n142         Africa   North America\n143  North America   North America\n144  North America   North America\n145           Asia   North America\n146           Asia   North America\n147  South America   South America\n148         Africa   South America\n149  North America   North America\n150  North America   North America\n151  South America   North America\n152  South America   North America\n153         Africa          Africa\n154  North America   North America\n155  North America   North America\n156  North America   North America\n157           Asia   North America\n158  North America   North America\n159  North America   South America\n160  North America   North America\n161  North America   North America\n162  South America   South America\n163  South America   South America\n164  South America   South America\n165  North America   North America\n166           Asia   South America\n167  South America   North America\n168  North America   North America\n169  South America   North America\n170  North America   North America\n171         Africa   North America\n172  North America   South America\n173           Asia   South America\n174  North America   North America\n175  South America   North America\n176           Asia   North America\n177  South America   North America\n178  South America   North America\n179  North America   North America\n180  North America   North America\n181  North America   North America\n182  South America   North America\n183  North America   North America\n184  North America          Africa\n185  South America   South America\n186  South America   North America\n187  North America   North America\n188  North America   South America\n189  North America          Africa\n190         Africa   North America\n191  South America   North America\n192  North America   North America\n193  North America   South America\n194  South America   South America\n195  North America   North America\n196  South America   North America\n197           Asia   North America\n198  North America   South America\n199  North America   South America\n200  North America   North America\n201  North America   North America\n202           Asia   North America\n203  North America   North America\n204         Africa          Africa\n205  North America   North America\n206  South America   North America\n207  North America   North America\n208  North America   South America\n209           Asia   North America\n210  North America   North America\n211  North America   North America\n212  North America   North America\n213           Asia   North America\n214  South America   South America\n215  North America   North America\n216  South America   North America\n217  North America   North America\n218  North America   North America\n219  South America   North America\n220  North America   North America\n221  North America   South America\n222  North America   North America\n223  North America   North America\n224         Africa   North America\n225  North America   South America\n226           Asia   North America\n227  South America   North America\n228  North America   North America\n229           Asia   North America\n230  North America   North America\n231         Africa          Africa\n232  North America   South America\n233           Asia   South America\n234  South America   South America\n235  North America   North America\n236  North America   North America\n237         Africa          Africa\n238  North America   North America\n239  North America   North America\n240  North America   North America\n241  South America   North America\n242           Asia   North America\n243  North America   North America\n244         Africa   South America\n245         Africa   North America\n246         Africa   South America\n247  South America   North America\n248  South America   South America\n249  South America   North America\n250  North America   North America\n251  South America   North America\n252  South America   South America\n253  North America   North America\n254  South America   North America\n255         Africa   North America\n256           Asia   North America\n257  North America   North America\n258           Asia   North America\n259  North America   North America\n260  North America   North America\n261  North America   North America\n262  North America   North America\n263  South America   South America\n264  South America   North America\n265  South America   North America\n266  North America   North America\n267         Africa   North America\n268  North America   North America\n269  North America   North America\n270  North America   North America\n271  North America   North America\n272         Africa   North America\n273  South America   South America\n274         Africa          Africa\n275  North America   North America\n276  North America   North America\n277  North America   North America\n278  North America   North America\n279  North America   North America\n280  South America   South America\n281  South America   North America\n282  South America   North America\n283  North America   North America\n284           Asia   South America\n285  North America   North America\n286           Asia   North America\n287  South America   North America\n288  North America   North America\n289  South America   South America\n290  North America   North America\n291  South America   South America\n292  South America   South America\n293  North America          Africa\n294           Asia   South America\n295         Africa   North America\n296  South America   North America\n297  South America   South America\n298  North America   North America\n299  North America   North America\n300  South America   North America\n301  North America   North America\n302  North America   North America\n303  South America   North America\n304  North America   North America\n305  South America   South America\n306  South America   South America\n307           Asia   North America\n308         Africa   South America\n309  North America   North America\n310  North America   North America\n311           Asia   North America\n312  South America   North America\n313  North America   South America\n314           Asia   North America\n315           Asia   North America\n316  North America   North America\n317  North America   North America\n318  North America   South America\n319  North America   South America\n320         Africa          Africa\n321  North America   North America\n322  South America   South America\n323  South America   South America\n324           Asia   North America\n325  South America   North America\n326  North America          Africa\n327  North America   North America\n328  North America   South America\n329         Africa   North America\n330  North America   North America\n331         Africa          Africa\n332  North America   North America\n333  North America   North America\n334  South America   South America\n335  South America   North America\n336  North America   North America\n337  North America   North America\n338         Africa          Africa\n339  North America   North America\n340  North America   North America\n341  North America   North America\n342  North America   North America\n343  North America   North America\n344           Asia   North America\n345         Africa   South America\n346  North America   North America\n347  South America   South America\n348  South America   North America\n349  South America   North America\n350  South America   North America\n351  North America   North America\n352  North America   North America\n353         Africa   North America\n354  South America   North America\n355  North America   North America\n356  North America   North America\n357  South America   North America\n358         Africa          Africa\n359         Africa          Africa\n360  North America   North America\n361  North America   North America\n362  South America   North America\n363  North America   North America\n364  North America   North America\n365           Asia   North America\n366         Africa   South America\n367  North America   North America\n368  South America   North America\n369  North America   North America\n370  North America   North America\n371         Africa   North America\n372  North America   North America\n373  South America   North America\n374           Asia   North America\n375  North America   North America\n376  South America   North America\n377  North America   North America\n378  North America   North America\n379  South America   South America\n380  North America   North America\n381         Africa   North America\n382  North America   North America\n383           Asia   South America\n384  South America   South America\n385  North America   North America\n386         Africa   North America\n387  North America   North America\n388  South America   South America\n389  North America   North America\n390  South America   North America\n391  North America   North America\n392  South America   South America\n393  South America   South America\n394  North America   North America\n395  North America   North America\n396  South America   South America\n397  South America   South America\n398         Africa          Africa\n399  North America   North America\n400  North America   South America\n401  North America          Africa\n402  North America   North America\n403           Asia   North America\n404  North America          Africa\n405           Asia   North America\n406           Asia   North America\n407  South America          Africa\n408  North America   North America\n409  South America   North America\n410           Asia   North America\n411  North America   North America\n412  North America   North America\n413  South America   South America\n414         Africa          Africa\n415  South America   South America\n416  South America   North America\n417           Asia   North America\n418         Africa   North America\n419         Africa          Africa\n420  North America   North America\n421           Asia   North America\n422  North America   South America\n423  North America   North America\n424  North America   North America\n425  North America   North America\n426  North America   North America\n427  North America   North America\n428  North America   South America\n429           Asia   North America\n430  North America          Africa\n431  North America   North America\n432         Africa   North America\n433  South America   North America\n434  North America   North America\n435           Asia   South America\n436           Asia   North America\n437  South America   North America\n438  South America   North America\n439  North America   North America\n440  North America   North America\n441  North America   North America\n442           Asia   North America\n443  North America   North America\n444  South America   South America\n445  South America   South America\n446           Asia   South America\n447  North America   South America\n448  North America   North America\n449  North America   South America\n450  South America   North America\n451  North America   North America\n452         Africa          Africa\n453  South America   North America\n454  North America   North America\n455  North America   North America\n456           Asia   North America\n457  North America   North America\n458  North America          Africa\n459  North America   North America\n460  North America   North America\n461  North America   North America\n462           Asia   North America\n463  North America   North America\n464  South America   South America\n465           Asia   North America\n466  North America   South America\n467           Asia          Africa\n468           Asia          Africa\n469         Africa   North America\n470  North America          Africa\n471           Asia   North America\n472  South America          Africa\n473         Africa   North America\n474         Africa   North America\n475  North America   South America\n476  North America   North America\n477         Africa          Africa\n478  North America   North America\n479           Asia   North America\n480  North America   North America\n481         Africa          Africa\n482  North America   North America\n483  North America   North America\n484  North America   North America\n485  South America   North America\n486  South America   North America\n487  North America   North America\n488  North America   North America\n489  South America   North America\n490         Africa          Africa\n491  North America   North America\n492  South America   South America\n493  North America   North America\n494  North America   North America\n495  South America   North America\n496  North America   North America\n497  South America   South America\n498  North America   North America\n499           Asia   North America\n500  South America   North America\n501  North America   South America\n502         Africa   North America\n503         Africa   North America\n504  South America   North America\n505  South America   South America\n506           Asia   South America\n507  North America   North America\n508  North America   North America\n509         Africa          Africa\n510  South America   North America\n511  North America   North America\n512  South America   South America\n513         Africa   North America\n514  South America   North America\n515         Africa   North America\n516         Africa   North America\n517  North America   North America\n518  South America   South America\n519  South America   North America\n520  North America   North America\n521  South America   North America\n522         Africa   North America\n523  South America   North America\n524  South America   North America\n525           Asia   North America\n526  North America          Africa\n527  South America   North America\n528  North America   North America\n529  South America   North America\n530  North America   North America\n531  North America   North America\n532  North America   North America\n533  North America   North America\n534  North America   North America\n535  South America   North America\n536           Asia   North America\n537           Asia   North America\n538           Asia   North America\n539  North America   South America\n540  South America   North America\n541  South America   South America\n542           Asia   North America\n543  North America          Africa\n544  North America   North America\n545  South America   South America\n546  North America   North America\n547  North America   North America\n548  North America   North America\n549  North America   North America\n550  South America   North America\n551         Africa   North America\n552  North America   North America\n553  North America   North America\n554         Africa   North America\n555  North America   North America\n556  South America   North America\n557  South America   South America\n558  South America   South America\n559  North America   North America\n560  South America   North America\n561  North America   North America\n562  South America   North America\n563  South America   South America\n564  North America   North America\n565  North America   North America\n566  North America   North America\n567  North America   North America\n568  North America   North America\n569  South America   North America\n570  North America   North America\n571  North America          Africa\n572  North America   North America\n573  North America   South America\n574  North America   South America\n575  North America   North America\n576  North America   North America\n577           Asia   North America\n578  North America   North America\n579           Asia          Africa\n580         Africa   North America\n581         Africa   North America\n582  North America   North America\n583  North America   North America\n584  North America   North America\n585           Asia   North America\n586  North America   North America\n587         Africa          Africa\n588  South America   North America\n589         Africa   South America\n590  North America   North America\n591  North America   North America\n592  South America   South America\n593  North America   North America\n594  North America   North America\n595  North America   North America\n596  North America   North America\n597  South America   South America\n598  North America   North America\n599  North America   North America\n600  North America   North America\n601  North America   North America\n602  South America   North America\n603  South America   North America\n604           Asia   North America\n605  North America   North America\n606  North America   South America\n607  North America   North America\n608  North America   North America\n609  South America          Africa\n610  North America   North America\n611  North America   North America\n612  South America   South America\n613  North America   North America\n614           Asia   North America\n615         Africa   North America\n616           Asia   North America\n617  South America   South America\n618           Asia   South America\n619  North America          Africa\n620  North America   North America\n621  North America   North America\n622  North America   North America\n623  South America   South America\n624           Asia   South America\n625  North America   South America\n626  North America   North America\n627  North America   North America\n628  North America   North America\n629  North America   North America\n630           Asia   South America\n631  South America   North America\n632  South America   South America\n633           Asia   North America\n634  South America   North America\n635  South America   North America\n636           Asia   North America\n637  North America          Africa\n638           Asia   South America\n639  South America   North America\n640  South America   North America\n641  South America   South America\n642  South America   North America\n643  North America   North America\n644  South America   South America\n645         Africa   North America\n646  South America   North America\n647  South America   South America\n648           Asia   North America\n649  South America   North America\n650         Africa   North America\n651  South America   North America\n652         Africa          Africa\n653         Africa   North America\n654  North America   North America\n655  South America   South America\n656  North America          Africa\n657  North America   North America\n658  North America   North America\n659  South America   South America\n660           Asia   South America\n661  North America   North America\n662  South America   South America\n663         Africa   North America\n664           Asia   South America\n665  South America   North America\n666  South America   North America\n667         Africa          Africa\n668  North America   North America\n669  North America   North America\n670  North America   North America\n671  North America   North America\n672           Asia   South America\n673  South America   South America\n674  South America   South America\n675  South America   North America\n676  North America   North America\n677           Asia   North America\n678  North America   North America\n679  North America   North America\n680  South America   South America\n681           Asia          Africa\n682  North America   North America\n683  North America   North America\n684  South America   South America\n685  South America   North America\n686  North America   North America\n687  North America          Africa\n688  North America   North America\n689  North America   North America\n690         Africa   North America\n691  South America   South America\n692  North America   North America\n693  North America   North America\n694         Africa   South America\n695  South America   North America\n696  South America   North America\n697  North America   North America\n698  South America   North America\n699  South America   North America\n700         Africa   North America\n701  North America   North America\n702  North America          Africa\n703  North America   North America\n704         Africa   South America\n705         Africa   North America\n706  South America          Africa\n707           Asia   South America\n708  North America   North America\n709  North America   North America\n710         Africa   North America\n711  North America   South America\n712           Asia   North America\n713  South America   North America\n714  North America   North America\n715  South America   North America\n716  North America   North America\n717  North America          Africa\n718           Asia   South America\n719  South America   North America\n720           Asia   North America\n721  North America   North America\n722         Africa   North America\n723  North America   North America\n724  South America   North America\n725         Africa   South America\n726  North America   North America\n727  North America   North America\n728           Asia   North America\n729         Africa   North America\n730  South America   South America\n731  North America   North America\n732  North America   North America\n733         Africa          Africa\n734  North America   North America\n735           Asia   South America\n736         Africa   North America\n737  North America   North America\n738  North America   South America\n739  North America   North America\n740  North America   North America\n741  North America   North America\n742  South America   North America\n743  South America   South America\n744  South America   South America\n745         Africa   North America\n746  North America   North America\n747  South America   North America\n748  South America   South America\n749  South America   South America\n750  North America   North America\n751  North America   North America\n752         Africa   North America\n753  North America   North America\n754  North America   North America\n755         Africa   North America\n756  North America          Africa\n757  South America   South America\n758  North America   North America\n759           Asia   North America\n760  North America   North America\n761  South America   North America\n762           Asia   North America\n763  North America   North America\n764  South America   North America\n765  North America          Africa\n766  North America   North America\n767  North America   North America\n768  North America   North America\n769  North America   South America\n770         Africa          Africa\n771           Asia   North America\n772  South America   North America\n773         Africa          Africa\n774  North America   North America\n775  North America   North America\n776  North America   North America\n777  North America   North America\n778  South America   South America\n779  South America   South America\n780  North America          Africa\n781  South America   South America\n782  North America   North America\n783  North America   North America\n784           Asia   North America\n785  South America   North America\n786  North America   North America\n787  North America   North America\n788  South America   North America\n789         Africa          Africa\n790         Africa   North America\n791  South America   South America\n792  North America   South America\n793  North America   North America\n794  North America   North America\n795  North America   South America\n796  North America   North America\n797           Asia   North America\n798  North America   North America\n799         Africa          Africa\n800         Africa          Africa\n801         Africa          Africa\n802         Africa   North America\n803  North America   North America\n804         Africa          Africa\n805         Africa   North America\n806         Africa   South America\n807  North America   North America\n808  North America   North America\n809  North America   North America\n810  North America   North America\n811  North America   North America\n812  North America   North America\n813         Africa   North America\n814  South America   North America\n815         Africa   South America\n816           Asia   North America\n817  North America   North America\n818  South America   North America\n819  South America          Africa\n820           Asia   North America\n821  North America          Africa\n822           Asia   North America\n823  South America   North America\n824  South America   North America\n825  North America   North America\n826  South America          Africa\n827         Africa   North America\n828  North America   North America\n829  South America   South America\n830  North America          Africa\n831         Africa   North America\n832  North America   North America\n833  North America   South America\n834  South America   North America\n835         Africa   North America\n836         Africa   North America\n837  North America   South America\n838  North America   North America\n839  North America   North America\n840  North America   North America\n841  North America   North America\n842  North America   North America\n843  North America   North America\n844  North America   North America\n845  North America   South America\n846  North America   North America\n847           Asia   North America\n848  North America   South America\n849  North America   North America\n850  North America   North America\n851  North America   North America\n852  North America   North America\n853  North America          Africa\n854         Africa          Africa\n855  North America   North America\n856  South America   South America\n857  South America   South America\n858  North America   North America\n859  North America   North America\n860  South America   South America\n861  North America   North America\n862  North America   North America\n863  North America   North America\n864  North America          Africa\n865  North America   North America\n866         Africa          Africa\n867  South America   North America\n868         Africa   North America\n869  North America   North America\n870  South America   South America\n871  South America   South America\n872           Asia   North America\n873  South America   North America\n874  North America   North America\n875  South America   North America\n876  South America   South America\n877  South America          Africa\n878  North America   North America\n879  North America   South America\n880  South America   South America\n881  North America          Africa\n882  South America   North America\n883         Africa   North America\n884  North America   North America\n885           Asia   North America\n886  South America   South America\n887  North America   North America\n888  South America          Africa\n889           Asia   North America\n890  North America   North America\n891           Asia   North America\n892           Asia   North America\n893  North America   North America\n894  North America   South America\n895           Asia   North America\n896  South America   North America\n897  North America   North America\n898  North America   North America\n899  North America   North America\n900  North America          Africa\n901  North America   South America\n902           Asia   North America\n903  South America   North America\n904  South America   South America\n905  South America   North America\n906  North America   North America\n907           Asia   North America\n908  South America   South America\n909  North America   North America\n910  North America   North America\n911  South America   North America\n912  North America   North America\n913  South America          Africa\n914  North America   South America\n915         Africa   South America\n916  South America   South America\n917           Asia   South America\n918  South America   North America\n919           Asia   South America\n920           Asia   North America\n921         Africa          Africa\n922  North America   North America\n923  North America   North America\n924  North America   North America\n925         Africa   North America\n926  North America   North America\n927           Asia   North America\n928  North America   North America\n929  North America   North America\n930  North America   North America\n931  South America   North America\n932  North America   North America\n933  North America   North America\n934  North America   North America\n935  North America   North America\n936         Africa   North America\n937  North America   North America\n938  North America   North America\n939  North America   North America\n940  South America   North America\n941           Asia   North America\n942  North America   North America\n943  North America   North America\n944         Africa          Africa\n945  South America   North America\n946  South America   North America\n947  North America   North America\n948  North America   North America\n949  North America   North America\n950  South America   North America\n951           Asia   South America\n952  North America   North America\n953  North America   North America\n954  North America   North America\n955  North America   North America\n956  South America   South America\n957  South America   South America\n958  North America   North America\n959  North America   North America\n960           Asia   South America\n961         Africa   North America\n962  North America   North America\n963  North America   North America\n964         Africa          Africa\n965  North America   North America\n966         Africa   North America\n967  North America   North America\n968           Asia   North America\n969  North America   North America\n970  North America   North America\n971           Asia   North America\n972         Africa   South America\n973  North America   North America\n974  North America   North America\n975  South America   South America\n976  North America   North America\n977  North America   North America\n978  South America   North America\n979  North America   South America\n980           Asia   North America\n981  North America   South America\n982  North America   North America\n983  North America   North America\n984  North America   North America\n985  South America   North America\n986  North America   North America\n987         Africa   South America\n988  North America   North America\n989  North America   North America\n990  North America   North America\n991         Africa          Africa\n992           Asia   South America\n993  South America          Africa\n994  South America   South America\n995           Asia   North America\n996           Asia   South America\n997           Asia   North America\n998  South America   North America\n999         Africa          Africa\n1000          Asia   North America\n1001 North America   South America\n1002 North America          Africa\n1003 North America   North America\n1004 South America   South America\n1005 South America   North America\n1006 North America   North America\n1007 North America   North America\n1008 North America   North America\n1009 North America   North America\n1010 North America   North America\n1011 North America   South America\n1012 North America   North America\n1013 North America   North America\n1014 North America   North America\n1015          Asia   South America\n1016 North America   South America\n1017        Africa   North America\n1018 North America   North America\n1019 North America   North America\n1020 South America   South America\n1021 North America   North America\n1022 South America   North America\n1023          Asia   North America\n1024 North America   North America\n1025 South America          Africa\n1026          Asia   North America\n1027 North America   North America\n1028          Asia   North America\n1029 South America   North America\n1030 South America   South America\n1031        Africa   North America\n1032 North America   North America\n1033 North America   North America\n1034 North America   South America\n1035 South America   South America\n1036 North America   North America\n1037 South America   North America\n1038 South America   North America\n1039 North America   North America\n1040 South America   North America\n1041 North America   North America\n1042        Africa   North America\n1043 North America   North America\n1044 North America   North America\n1045 North America   North America\n1046        Africa   North America\n1047 North America   North America\n1048 South America   North America\n1049 North America          Africa\n1050 North America   North America\n1051 North America   North America\n1052          Asia   North America\n1053 North America   North America\n1054          Asia          Africa\n1055 South America   North America\n1056 North America   North America\n1057          Asia   South America\n1058 South America   North America\n1059          Asia   South America\n1060          Asia   North America\n1061 South America   North America\n1062 South America   North America\n1063 North America   North America\n1064          Asia   North America\n1065        Africa          Africa\n1066 North America          Africa\n1067 North America   North America\n1068 South America   South America\n1069 North America   North America\n```\n\n\n:::\n\n```{.r .cell-code}\npredict_new <- test %>%\n  select(continent) %>%\n  bind_cols(\n    predict(mod_tree_all, new_data = new_test, type = \"class\")\n  ) %>%\n  rename(continent_dtree = .pred_class)\npredict_new\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        continent continent_dtree\n1   South America   North America\n2   South America   North America\n3   South America   South America\n4   South America   North America\n5   South America   North America\n6   South America   North America\n7   South America   North America\n8   South America   North America\n9   South America   North America\n10  South America   North America\n11  South America   North America\n12  South America   South America\n13  South America   North America\n14  South America   North America\n15  South America   North America\n16  South America   North America\n17  South America   North America\n18  South America   North America\n19  South America   North America\n20  South America   North America\n21  South America   North America\n22  South America   North America\n23  South America   North America\n24  South America   North America\n25  South America   North America\n26  South America   North America\n27  South America   North America\n28  South America   North America\n29  South America   North America\n30         Africa   South America\n31           Asia   South America\n32           Asia   North America\n33           Asia   North America\n34           Asia   North America\n35           Asia   North America\n36           Asia   North America\n37  South America   North America\n38  South America   North America\n39  South America   South America\n40  South America   North America\n41  South America   North America\n42  South America   South America\n43  South America   South America\n44  South America   North America\n45  South America   North America\n46  South America          Africa\n47  South America   South America\n48  South America   North America\n49  South America   South America\n50  South America   South America\n51  South America   South America\n52  South America   South America\n53  South America   South America\n54  South America   South America\n55  South America   South America\n56  South America   North America\n57  South America   South America\n58  South America   North America\n59  South America   North America\n60  South America   North America\n61  South America   North America\n62  South America          Africa\n63  South America   South America\n64  South America   South America\n65  South America   North America\n66  South America   North America\n67  South America   North America\n68  South America   South America\n69  North America   North America\n70  North America   South America\n71  North America   North America\n72  North America   South America\n73  North America          Africa\n74  North America   North America\n75  North America   North America\n76  North America   North America\n77  North America   North America\n78  North America          Africa\n79  North America   North America\n80  North America          Africa\n81  North America   South America\n82  North America          Africa\n83  North America   South America\n84  North America   South America\n85  North America          Africa\n86  South America   South America\n87  North America   North America\n88  North America          Africa\n89  North America   North America\n90  North America   South America\n91  North America          Africa\n92         Africa          Africa\n93         Africa          Africa\n94         Africa   North America\n95         Africa          Africa\n96         Africa          Africa\n97         Africa          Africa\n98         Africa          Africa\n99         Africa   North America\n100        Africa          Africa\n101 North America   North America\n102 North America   South America\n103 North America   South America\n104 North America   North America\n105 North America   North America\n106 North America   North America\n107 North America   South America\n108 North America   North America\n109 North America   North America\n110 North America   North America\n111 North America   North America\n112 North America   North America\n113 North America   North America\n114 North America   North America\n115 North America   North America\n116 North America   North America\n117 North America   North America\n118 North America   South America\n119 North America   North America\n120 North America   North America\n121 North America   North America\n122 North America   North America\n123 North America   North America\n124 North America   North America\n125 North America   North America\n126 North America   North America\n127 North America   North America\n128 North America   North America\n129 North America   North America\n130 North America   North America\n131 North America   North America\n132 North America   North America\n133 North America   North America\n134 North America   North America\n135 North America   North America\n136 North America   North America\n137 North America   North America\n138 North America   North America\n139 North America   North America\n140 North America   North America\n141 North America   North America\n142 North America   North America\n143 North America   North America\n144          Asia   North America\n145          Asia   North America\n146          Asia   North America\n147          Asia   North America\n148          Asia   North America\n149          Asia   North America\n150          Asia   North America\n151          Asia   North America\n152          Asia   North America\n153          Asia   North America\n154        Africa   North America\n155        Africa   North America\n156        Africa   North America\n157        Africa   North America\n158        Africa   North America\n159        Africa          Africa\n160        Africa   North America\n161        Africa   North America\n162        Africa   North America\n163        Africa   North America\n164        Africa   North America\n165 North America   North America\n166 North America   North America\n167 North America   North America\n168 North America   North America\n169 North America   North America\n170 North America   North America\n171 North America   North America\n172 North America   North America\n173 North America   North America\n174 North America   North America\n175 North America   North America\n176 North America   North America\n177 North America   North America\n178 North America   North America\n179 North America   North America\n180 North America   North America\n181 North America   North America\n182 North America   North America\n183 North America   North America\n184 North America   North America\n185 North America   North America\n186 North America   North America\n187 North America   North America\n188 North America   North America\n189 North America   North America\n190 North America   North America\n191 North America   North America\n192 North America   North America\n193 North America   North America\n194 North America   South America\n195 North America   North America\n196 North America   North America\n197 North America   North America\n198 North America   North America\n199 North America   North America\n200 North America   North America\n201 North America   North America\n202 North America   North America\n203 North America   North America\n204 North America   North America\n205 North America   North America\n206 North America   North America\n207 North America   South America\n208 North America   North America\n209          Asia   North America\n210 North America   North America\n211 North America   North America\n212 North America   North America\n213 North America   North America\n214 North America          Africa\n215 North America   North America\n216 North America   North America\n217 North America   North America\n218 North America   North America\n219 South America          Africa\n220 South America   North America\n221          Asia   North America\n222 North America   North America\n223          Asia   South America\n224          Asia   North America\n225          Asia   North America\n226          Asia   North America\n227          Asia   North America\n228          Asia   North America\n229          Asia   North America\n230          Asia   North America\n231          Asia   South America\n232          Asia   South America\n233          Asia   North America\n234          Asia   North America\n235        Africa   South America\n236        Africa   North America\n237        Africa   South America\n238        Africa   North America\n239        Africa   North America\n240          Asia   North America\n241          Asia   North America\n242          Asia   North America\n243          Asia   North America\n244          Asia   North America\n245          Asia   North America\n246          Asia   North America\n247          Asia   South America\n248        Africa   South America\n249        Africa          Africa\n250        Africa   North America\n251        Africa   North America\n252        Africa   South America\n253        Africa   South America\n254 North America   North America\n255 North America   North America\n256 North America   North America\n257 North America          Africa\n258 North America          Africa\n259 North America   South America\n260 North America   South America\n261 North America   North America\n262 North America   North America\n263 North America   North America\n264 North America   North America\n265 North America   North America\n266 North America   North America\n267          Asia   North America\n268          Asia   South America\n```\n\n\n:::\n\n```{.r .cell-code}\naccuracy(pred_all, continent, continent_dtree)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric  .estimator .estimate\n  <chr>    <chr>          <dbl>\n1 accuracy multiclass     0.550\n```\n\n\n:::\n\n```{.r .cell-code}\naccuracy(predict_new, continent, continent_dtree)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric  .estimator .estimate\n  <chr>    <chr>          <dbl>\n1 accuracy multiclass     0.504\n```\n\n\n:::\n\n```{.r .cell-code}\nconf_matrix <- pred_all %>% \n  conf_mat(truth = continent, estimate = continent_dtree)\nconf_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Truth\nPrediction      Africa Asia North America South America\n  Africa            40    6            31            12\n  Asia               0    0             0             0\n  North America     74  105           446           150\n  South America     16   31            56           102\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod_forest <- rand_forest(\n  mode = \"classification\", \n  mtry = 6, \n  trees = 250) %>%\n    set_engine(\"randomForest\") %>%\n      fit(formula = form_all, data = train)\n\npred_forest <- train %>%\n  select(continent) %>%\n  bind_cols(\n    predict(mod_forest, new_data = train, type = \"class\")\n  ) \npred_forest\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         continent   .pred_class\n1    North America North America\n2    North America North America\n3             Asia          Asia\n4    South America South America\n5    North America North America\n6           Africa        Africa\n7             Asia          Asia\n8    South America North America\n9    North America North America\n10   North America North America\n11   South America South America\n12          Africa        Africa\n13   South America South America\n14            Asia          Asia\n15            Asia          Asia\n16   North America North America\n17   South America South America\n18          Africa        Africa\n19   North America North America\n20   North America North America\n21   North America North America\n22   North America North America\n23   North America North America\n24   North America North America\n25            Asia          Asia\n26   South America South America\n27   North America North America\n28   South America South America\n29   North America North America\n30          Africa        Africa\n31   North America North America\n32   South America South America\n33   South America South America\n34   North America North America\n35   North America North America\n36   South America South America\n37            Asia          Asia\n38   North America North America\n39            Asia          Asia\n40   North America North America\n41          Africa        Africa\n42   South America South America\n43   North America North America\n44   North America South America\n45   North America North America\n46   North America North America\n47   South America South America\n48   North America North America\n49   North America North America\n50   South America South America\n51   North America North America\n52          Africa        Africa\n53   North America North America\n54   North America North America\n55   South America South America\n56   North America North America\n57   North America North America\n58   North America North America\n59   North America North America\n60            Asia          Asia\n61   North America North America\n62   North America North America\n63   North America North America\n64   North America North America\n65   North America North America\n66            Asia          Asia\n67   South America South America\n68   North America North America\n69   North America North America\n70   North America North America\n71   North America North America\n72            Asia          Asia\n73   North America North America\n74            Asia          Asia\n75            Asia          Asia\n76   North America North America\n77   North America North America\n78            Asia          Asia\n79   South America South America\n80          Africa        Africa\n81          Africa        Africa\n82   South America South America\n83   North America North America\n84          Africa        Africa\n85          Africa        Africa\n86          Africa        Africa\n87   North America North America\n88          Africa        Africa\n89   North America North America\n90   North America North America\n91   North America North America\n92   North America North America\n93          Africa        Africa\n94   North America North America\n95   North America North America\n96   South America South America\n97   North America North America\n98   North America North America\n99   North America North America\n100  North America North America\n101  North America North America\n102  North America North America\n103         Africa        Africa\n104  North America North America\n105  South America South America\n106  South America South America\n107  North America North America\n108           Asia          Asia\n109           Asia          Asia\n110  North America North America\n111           Asia          Asia\n112  North America North America\n113  North America North America\n114  South America        Africa\n115  North America North America\n116  North America North America\n117         Africa        Africa\n118  North America North America\n119  South America South America\n120  South America South America\n121  North America North America\n122  South America South America\n123  South America South America\n124  South America South America\n125  North America North America\n126           Asia          Asia\n127           Asia          Asia\n128  North America North America\n129  South America South America\n130  North America          Asia\n131           Asia          Asia\n132           Asia          Asia\n133  North America North America\n134  North America North America\n135           Asia          Asia\n136  North America North America\n137  North America North America\n138           Asia          Asia\n139  North America North America\n140         Africa        Africa\n141           Asia          Asia\n142         Africa        Africa\n143  North America North America\n144  North America North America\n145           Asia          Asia\n146           Asia          Asia\n147  South America South America\n148         Africa        Africa\n149  North America North America\n150  North America North America\n151  South America South America\n152  South America South America\n153         Africa        Africa\n154  North America North America\n155  North America North America\n156  North America North America\n157           Asia          Asia\n158  North America North America\n159  North America North America\n160  North America North America\n161  North America North America\n162  South America South America\n163  South America South America\n164  South America South America\n165  North America North America\n166           Asia South America\n167  South America South America\n168  North America North America\n169  South America South America\n170  North America North America\n171         Africa        Africa\n172  North America North America\n173           Asia          Asia\n174  North America North America\n175  South America South America\n176           Asia North America\n177  South America South America\n178  South America South America\n179  North America North America\n180  North America North America\n181  North America North America\n182  South America South America\n183  North America North America\n184  North America North America\n185  South America South America\n186  South America South America\n187  North America North America\n188  North America North America\n189  North America North America\n190         Africa        Africa\n191  South America South America\n192  North America North America\n193  North America North America\n194  South America South America\n195  North America North America\n196  South America South America\n197           Asia          Asia\n198  North America North America\n199  North America North America\n200  North America North America\n201  North America North America\n202           Asia          Asia\n203  North America North America\n204         Africa        Africa\n205  North America North America\n206  South America South America\n207  North America North America\n208  North America North America\n209           Asia          Asia\n210  North America North America\n211  North America North America\n212  North America North America\n213           Asia          Asia\n214  South America South America\n215  North America North America\n216  South America South America\n217  North America North America\n218  North America North America\n219  South America South America\n220  North America North America\n221  North America North America\n222  North America North America\n223  North America North America\n224         Africa        Africa\n225  North America North America\n226           Asia          Asia\n227  South America South America\n228  North America North America\n229           Asia          Asia\n230  North America North America\n231         Africa        Africa\n232  North America North America\n233           Asia          Asia\n234  South America South America\n235  North America North America\n236  North America North America\n237         Africa        Africa\n238  North America North America\n239  North America North America\n240  North America North America\n241  South America South America\n242           Asia          Asia\n243  North America North America\n244         Africa        Africa\n245         Africa        Africa\n246         Africa        Africa\n247  South America South America\n248  South America South America\n249  South America South America\n250  North America North America\n251  South America South America\n252  South America South America\n253  North America North America\n254  South America South America\n255         Africa        Africa\n256           Asia          Asia\n257  North America North America\n258           Asia          Asia\n259  North America North America\n260  North America North America\n261  North America North America\n262  North America North America\n263  South America South America\n264  South America South America\n265  South America North America\n266  North America North America\n267         Africa        Africa\n268  North America North America\n269  North America North America\n270  North America North America\n271  North America North America\n272         Africa        Africa\n273  South America South America\n274         Africa        Africa\n275  North America North America\n276  North America North America\n277  North America North America\n278  North America North America\n279  North America North America\n280  South America South America\n281  South America South America\n282  South America South America\n283  North America North America\n284           Asia          Asia\n285  North America North America\n286           Asia          Asia\n287  South America South America\n288  North America North America\n289  South America South America\n290  North America North America\n291  South America South America\n292  South America South America\n293  North America North America\n294           Asia          Asia\n295         Africa        Africa\n296  South America South America\n297  South America South America\n298  North America North America\n299  North America North America\n300  South America South America\n301  North America North America\n302  North America North America\n303  South America South America\n304  North America North America\n305  South America South America\n306  South America South America\n307           Asia          Asia\n308         Africa        Africa\n309  North America North America\n310  North America North America\n311           Asia          Asia\n312  South America South America\n313  North America North America\n314           Asia          Asia\n315           Asia          Asia\n316  North America North America\n317  North America North America\n318  North America North America\n319  North America North America\n320         Africa        Africa\n321  North America North America\n322  South America South America\n323  South America South America\n324           Asia          Asia\n325  South America South America\n326  North America North America\n327  North America North America\n328  North America North America\n329         Africa        Africa\n330  North America North America\n331         Africa        Africa\n332  North America North America\n333  North America North America\n334  South America South America\n335  South America South America\n336  North America North America\n337  North America North America\n338         Africa        Africa\n339  North America North America\n340  North America North America\n341  North America North America\n342  North America North America\n343  North America North America\n344           Asia          Asia\n345         Africa        Africa\n346  North America North America\n347  South America South America\n348  South America South America\n349  South America South America\n350  South America South America\n351  North America North America\n352  North America North America\n353         Africa        Africa\n354  South America South America\n355  North America North America\n356  North America North America\n357  South America South America\n358         Africa        Africa\n359         Africa        Africa\n360  North America North America\n361  North America North America\n362  South America South America\n363  North America North America\n364  North America North America\n365           Asia          Asia\n366         Africa        Africa\n367  North America North America\n368  South America South America\n369  North America North America\n370  North America North America\n371         Africa        Africa\n372  North America North America\n373  South America South America\n374           Asia          Asia\n375  North America North America\n376  South America South America\n377  North America North America\n378  North America North America\n379  South America South America\n380  North America North America\n381         Africa        Africa\n382  North America North America\n383           Asia          Asia\n384  South America South America\n385  North America North America\n386         Africa        Africa\n387  North America North America\n388  South America South America\n389  North America North America\n390  South America South America\n391  North America North America\n392  South America South America\n393  South America South America\n394  North America North America\n395  North America North America\n396  South America South America\n397  South America South America\n398         Africa        Africa\n399  North America North America\n400  North America North America\n401  North America North America\n402  North America North America\n403           Asia          Asia\n404  North America North America\n405           Asia          Asia\n406           Asia          Asia\n407  South America South America\n408  North America North America\n409  South America South America\n410           Asia          Asia\n411  North America North America\n412  North America North America\n413  South America South America\n414         Africa        Africa\n415  South America South America\n416  South America South America\n417           Asia          Asia\n418         Africa        Africa\n419         Africa        Africa\n420  North America North America\n421           Asia          Asia\n422  North America North America\n423  North America North America\n424  North America North America\n425  North America        Africa\n426  North America North America\n427  North America North America\n428  North America North America\n429           Asia          Asia\n430  North America North America\n431  North America North America\n432         Africa        Africa\n433  South America South America\n434  North America North America\n435           Asia          Asia\n436           Asia          Asia\n437  South America South America\n438  South America South America\n439  North America North America\n440  North America North America\n441  North America North America\n442           Asia          Asia\n443  North America North America\n444  South America South America\n445  South America South America\n446           Asia          Asia\n447  North America North America\n448  North America North America\n449  North America North America\n450  South America South America\n451  North America North America\n452         Africa        Africa\n453  South America South America\n454  North America North America\n455  North America North America\n456           Asia          Asia\n457  North America North America\n458  North America North America\n459  North America North America\n460  North America North America\n461  North America North America\n462           Asia          Asia\n463  North America North America\n464  South America South America\n465           Asia          Asia\n466  North America North America\n467           Asia          Asia\n468           Asia          Asia\n469         Africa        Africa\n470  North America North America\n471           Asia          Asia\n472  South America South America\n473         Africa        Africa\n474         Africa        Africa\n475  North America South America\n476  North America North America\n477         Africa        Africa\n478  North America North America\n479           Asia          Asia\n480  North America North America\n481         Africa        Africa\n482  North America North America\n483  North America North America\n484  North America North America\n485  South America South America\n486  South America South America\n487  North America North America\n488  North America North America\n489  South America South America\n490         Africa        Africa\n491  North America North America\n492  South America South America\n493  North America North America\n494  North America North America\n495  South America North America\n496  North America North America\n497  South America South America\n498  North America North America\n499           Asia          Asia\n500  South America South America\n501  North America North America\n502         Africa        Africa\n503         Africa        Africa\n504  South America South America\n505  South America South America\n506           Asia          Asia\n507  North America North America\n508  North America North America\n509         Africa        Africa\n510  South America South America\n511  North America North America\n512  South America South America\n513         Africa        Africa\n514  South America South America\n515         Africa        Africa\n516         Africa        Africa\n517  North America North America\n518  South America South America\n519  South America South America\n520  North America North America\n521  South America South America\n522         Africa        Africa\n523  South America South America\n524  South America South America\n525           Asia          Asia\n526  North America North America\n527  South America South America\n528  North America North America\n529  South America South America\n530  North America North America\n531  North America North America\n532  North America North America\n533  North America North America\n534  North America North America\n535  South America South America\n536           Asia          Asia\n537           Asia          Asia\n538           Asia          Asia\n539  North America North America\n540  South America South America\n541  South America South America\n542           Asia          Asia\n543  North America North America\n544  North America North America\n545  South America South America\n546  North America North America\n547  North America North America\n548  North America North America\n549  North America North America\n550  South America South America\n551         Africa        Africa\n552  North America North America\n553  North America North America\n554         Africa        Africa\n555  North America North America\n556  South America South America\n557  South America South America\n558  South America South America\n559  North America North America\n560  South America South America\n561  North America North America\n562  South America South America\n563  South America South America\n564  North America North America\n565  North America North America\n566  North America North America\n567  North America North America\n568  North America North America\n569  South America South America\n570  North America North America\n571  North America North America\n572  North America North America\n573  North America North America\n574  North America North America\n575  North America North America\n576  North America North America\n577           Asia          Asia\n578  North America North America\n579           Asia          Asia\n580         Africa        Africa\n581         Africa        Africa\n582  North America North America\n583  North America North America\n584  North America North America\n585           Asia          Asia\n586  North America North America\n587         Africa        Africa\n588  South America South America\n589         Africa        Africa\n590  North America North America\n591  North America North America\n592  South America South America\n593  North America North America\n594  North America North America\n595  North America North America\n596  North America North America\n597  South America South America\n598  North America North America\n599  North America North America\n600  North America North America\n601  North America North America\n602  South America North America\n603  South America South America\n604           Asia          Asia\n605  North America North America\n606  North America North America\n607  North America North America\n608  North America North America\n609  South America South America\n610  North America North America\n611  North America North America\n612  South America South America\n613  North America North America\n614           Asia          Asia\n615         Africa        Africa\n616           Asia          Asia\n617  South America South America\n618           Asia          Asia\n619  North America North America\n620  North America North America\n621  North America North America\n622  North America North America\n623  South America South America\n624           Asia          Asia\n625  North America North America\n626  North America North America\n627  North America North America\n628  North America North America\n629  North America North America\n630           Asia          Asia\n631  South America South America\n632  South America South America\n633           Asia          Asia\n634  South America South America\n635  South America South America\n636           Asia          Asia\n637  North America North America\n638           Asia          Asia\n639  South America South America\n640  South America South America\n641  South America South America\n642  South America South America\n643  North America North America\n644  South America South America\n645         Africa        Africa\n646  South America South America\n647  South America South America\n648           Asia          Asia\n649  South America North America\n650         Africa        Africa\n651  South America South America\n652         Africa        Africa\n653         Africa        Africa\n654  North America North America\n655  South America South America\n656  North America North America\n657  North America North America\n658  North America North America\n659  South America South America\n660           Asia          Asia\n661  North America North America\n662  South America South America\n663         Africa        Africa\n664           Asia          Asia\n665  South America South America\n666  South America South America\n667         Africa        Africa\n668  North America North America\n669  North America North America\n670  North America North America\n671  North America North America\n672           Asia          Asia\n673  South America South America\n674  South America South America\n675  South America South America\n676  North America North America\n677           Asia          Asia\n678  North America North America\n679  North America North America\n680  South America South America\n681           Asia          Asia\n682  North America North America\n683  North America North America\n684  South America South America\n685  South America South America\n686  North America North America\n687  North America North America\n688  North America North America\n689  North America North America\n690         Africa        Africa\n691  South America South America\n692  North America North America\n693  North America North America\n694         Africa        Africa\n695  South America South America\n696  South America South America\n697  North America North America\n698  South America South America\n699  South America South America\n700         Africa        Africa\n701  North America North America\n702  North America North America\n703  North America North America\n704         Africa        Africa\n705         Africa        Africa\n706  South America South America\n707           Asia          Asia\n708  North America North America\n709  North America North America\n710         Africa        Africa\n711  North America North America\n712           Asia          Asia\n713  South America South America\n714  North America North America\n715  South America South America\n716  North America North America\n717  North America North America\n718           Asia          Asia\n719  South America South America\n720           Asia          Asia\n721  North America North America\n722         Africa        Africa\n723  North America North America\n724  South America South America\n725         Africa        Africa\n726  North America North America\n727  North America North America\n728           Asia          Asia\n729         Africa        Africa\n730  South America South America\n731  North America North America\n732  North America North America\n733         Africa        Africa\n734  North America North America\n735           Asia          Asia\n736         Africa        Africa\n737  North America North America\n738  North America North America\n739  North America North America\n740  North America North America\n741  North America North America\n742  South America South America\n743  South America South America\n744  South America South America\n745         Africa        Africa\n746  North America North America\n747  South America South America\n748  South America South America\n749  South America South America\n750  North America North America\n751  North America North America\n752         Africa        Africa\n753  North America North America\n754  North America North America\n755         Africa        Africa\n756  North America North America\n757  South America South America\n758  North America North America\n759           Asia          Asia\n760  North America North America\n761  South America South America\n762           Asia          Asia\n763  North America North America\n764  South America South America\n765  North America North America\n766  North America North America\n767  North America North America\n768  North America North America\n769  North America North America\n770         Africa        Africa\n771           Asia          Asia\n772  South America South America\n773         Africa        Africa\n774  North America North America\n775  North America North America\n776  North America North America\n777  North America North America\n778  South America South America\n779  South America South America\n780  North America North America\n781  South America South America\n782  North America North America\n783  North America North America\n784           Asia          Asia\n785  South America South America\n786  North America North America\n787  North America North America\n788  South America South America\n789         Africa        Africa\n790         Africa        Africa\n791  South America South America\n792  North America North America\n793  North America North America\n794  North America North America\n795  North America North America\n796  North America North America\n797           Asia          Asia\n798  North America North America\n799         Africa        Africa\n800         Africa        Africa\n801         Africa        Africa\n802         Africa        Africa\n803  North America North America\n804         Africa        Africa\n805         Africa        Africa\n806         Africa        Africa\n807  North America North America\n808  North America North America\n809  North America North America\n810  North America North America\n811  North America North America\n812  North America North America\n813         Africa        Africa\n814  South America South America\n815         Africa        Africa\n816           Asia          Asia\n817  North America North America\n818  South America North America\n819  South America South America\n820           Asia          Asia\n821  North America North America\n822           Asia          Asia\n823  South America South America\n824  South America South America\n825  North America North America\n826  South America South America\n827         Africa        Africa\n828  North America North America\n829  South America South America\n830  North America North America\n831         Africa        Africa\n832  North America North America\n833  North America North America\n834  South America South America\n835         Africa        Africa\n836         Africa        Africa\n837  North America North America\n838  North America North America\n839  North America North America\n840  North America North America\n841  North America North America\n842  North America North America\n843  North America North America\n844  North America North America\n845  North America North America\n846  North America North America\n847           Asia North America\n848  North America North America\n849  North America North America\n850  North America North America\n851  North America North America\n852  North America North America\n853  North America North America\n854         Africa        Africa\n855  North America North America\n856  South America South America\n857  South America South America\n858  North America North America\n859  North America North America\n860  South America South America\n861  North America North America\n862  North America North America\n863  North America North America\n864  North America North America\n865  North America North America\n866         Africa        Africa\n867  South America South America\n868         Africa        Africa\n869  North America North America\n870  South America South America\n871  South America South America\n872           Asia          Asia\n873  South America South America\n874  North America North America\n875  South America South America\n876  South America South America\n877  South America South America\n878  North America North America\n879  North America North America\n880  South America South America\n881  North America North America\n882  South America South America\n883         Africa        Africa\n884  North America North America\n885           Asia          Asia\n886  South America South America\n887  North America North America\n888  South America South America\n889           Asia          Asia\n890  North America North America\n891           Asia          Asia\n892           Asia          Asia\n893  North America North America\n894  North America North America\n895           Asia          Asia\n896  South America South America\n897  North America North America\n898  North America North America\n899  North America North America\n900  North America North America\n901  North America North America\n902           Asia          Asia\n903  South America South America\n904  South America South America\n905  South America North America\n906  North America North America\n907           Asia          Asia\n908  South America South America\n909  North America North America\n910  North America North America\n911  South America South America\n912  North America North America\n913  South America South America\n914  North America North America\n915         Africa        Africa\n916  South America South America\n917           Asia          Asia\n918  South America South America\n919           Asia          Asia\n920           Asia          Asia\n921         Africa        Africa\n922  North America North America\n923  North America North America\n924  North America North America\n925         Africa        Africa\n926  North America North America\n927           Asia          Asia\n928  North America North America\n929  North America North America\n930  North America North America\n931  South America South America\n932  North America North America\n933  North America North America\n934  North America North America\n935  North America North America\n936         Africa        Africa\n937  North America North America\n938  North America North America\n939  North America North America\n940  South America South America\n941           Asia          Asia\n942  North America North America\n943  North America North America\n944         Africa        Africa\n945  South America South America\n946  South America South America\n947  North America North America\n948  North America North America\n949  North America North America\n950  South America South America\n951           Asia          Asia\n952  North America North America\n953  North America North America\n954  North America North America\n955  North America North America\n956  South America South America\n957  South America South America\n958  North America North America\n959  North America North America\n960           Asia          Asia\n961         Africa        Africa\n962  North America North America\n963  North America North America\n964         Africa        Africa\n965  North America North America\n966         Africa        Africa\n967  North America North America\n968           Asia          Asia\n969  North America North America\n970  North America North America\n971           Asia          Asia\n972         Africa        Africa\n973  North America North America\n974  North America North America\n975  South America South America\n976  North America North America\n977  North America North America\n978  South America South America\n979  North America North America\n980           Asia          Asia\n981  North America North America\n982  North America North America\n983  North America North America\n984  North America North America\n985  South America South America\n986  North America North America\n987         Africa        Africa\n988  North America          Asia\n989  North America North America\n990  North America North America\n991         Africa        Africa\n992           Asia          Asia\n993  South America South America\n994  South America South America\n995           Asia          Asia\n996           Asia          Asia\n997           Asia          Asia\n998  South America South America\n999         Africa        Africa\n1000          Asia          Asia\n1001 North America North America\n1002 North America North America\n1003 North America North America\n1004 South America South America\n1005 South America South America\n1006 North America North America\n1007 North America North America\n1008 North America North America\n1009 North America North America\n1010 North America North America\n1011 North America North America\n1012 North America North America\n1013 North America North America\n1014 North America North America\n1015          Asia          Asia\n1016 North America North America\n1017        Africa        Africa\n1018 North America North America\n1019 North America North America\n1020 South America South America\n1021 North America North America\n1022 South America South America\n1023          Asia          Asia\n1024 North America North America\n1025 South America South America\n1026          Asia          Asia\n1027 North America North America\n1028          Asia          Asia\n1029 South America South America\n1030 South America South America\n1031        Africa        Africa\n1032 North America North America\n1033 North America North America\n1034 North America North America\n1035 South America South America\n1036 North America North America\n1037 South America South America\n1038 South America South America\n1039 North America North America\n1040 South America South America\n1041 North America North America\n1042        Africa        Africa\n1043 North America North America\n1044 North America North America\n1045 North America North America\n1046        Africa        Africa\n1047 North America North America\n1048 South America South America\n1049 North America North America\n1050 North America North America\n1051 North America North America\n1052          Asia          Asia\n1053 North America North America\n1054          Asia          Asia\n1055 South America South America\n1056 North America North America\n1057          Asia          Asia\n1058 South America South America\n1059          Asia          Asia\n1060          Asia          Asia\n1061 South America South America\n1062 South America South America\n1063 North America North America\n1064          Asia          Asia\n1065        Africa        Africa\n1066 North America North America\n1067 North America North America\n1068 South America South America\n1069 North America North America\n```\n\n\n:::\n\n```{.r .cell-code}\npred_forest_train <- train %>%\n  select(continent) %>%\n  bind_cols(\n    predict(mod_forest, new_data = new_train, type = \"class\")\n  ) \npred_forest_train\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         continent   .pred_class\n1    North America North America\n2    North America North America\n3             Asia          Asia\n4    South America South America\n5    North America North America\n6           Africa        Africa\n7             Asia          Asia\n8    South America North America\n9    North America North America\n10   North America North America\n11   South America South America\n12          Africa        Africa\n13   South America South America\n14            Asia          Asia\n15            Asia          Asia\n16   North America North America\n17   South America South America\n18          Africa        Africa\n19   North America North America\n20   North America North America\n21   North America North America\n22   North America North America\n23   North America North America\n24   North America North America\n25            Asia          Asia\n26   South America South America\n27   North America North America\n28   South America South America\n29   North America North America\n30          Africa        Africa\n31   North America North America\n32   South America South America\n33   South America South America\n34   North America North America\n35   North America North America\n36   South America South America\n37            Asia          Asia\n38   North America North America\n39            Asia          Asia\n40   North America North America\n41          Africa        Africa\n42   South America South America\n43   North America North America\n44   North America South America\n45   North America North America\n46   North America North America\n47   South America South America\n48   North America North America\n49   North America North America\n50   South America South America\n51   North America North America\n52          Africa        Africa\n53   North America North America\n54   North America North America\n55   South America South America\n56   North America North America\n57   North America North America\n58   North America North America\n59   North America North America\n60            Asia          Asia\n61   North America North America\n62   North America North America\n63   North America North America\n64   North America North America\n65   North America North America\n66            Asia          Asia\n67   South America South America\n68   North America North America\n69   North America North America\n70   North America North America\n71   North America North America\n72            Asia          Asia\n73   North America North America\n74            Asia          Asia\n75            Asia          Asia\n76   North America North America\n77   North America North America\n78            Asia          Asia\n79   South America South America\n80          Africa        Africa\n81          Africa        Africa\n82   South America South America\n83   North America North America\n84          Africa        Africa\n85          Africa        Africa\n86          Africa        Africa\n87   North America North America\n88          Africa        Africa\n89   North America North America\n90   North America North America\n91   North America North America\n92   North America North America\n93          Africa        Africa\n94   North America North America\n95   North America North America\n96   South America South America\n97   North America North America\n98   North America North America\n99   North America North America\n100  North America North America\n101  North America North America\n102  North America North America\n103         Africa        Africa\n104  North America North America\n105  South America South America\n106  South America South America\n107  North America North America\n108           Asia          Asia\n109           Asia          Asia\n110  North America North America\n111           Asia          Asia\n112  North America North America\n113  North America North America\n114  South America        Africa\n115  North America North America\n116  North America North America\n117         Africa        Africa\n118  North America North America\n119  South America South America\n120  South America South America\n121  North America North America\n122  South America South America\n123  South America South America\n124  South America South America\n125  North America North America\n126           Asia          Asia\n127           Asia          Asia\n128  North America North America\n129  South America South America\n130  North America          Asia\n131           Asia          Asia\n132           Asia          Asia\n133  North America North America\n134  North America North America\n135           Asia          Asia\n136  North America North America\n137  North America North America\n138           Asia          Asia\n139  North America North America\n140         Africa        Africa\n141           Asia          Asia\n142         Africa        Africa\n143  North America North America\n144  North America North America\n145           Asia          Asia\n146           Asia          Asia\n147  South America South America\n148         Africa        Africa\n149  North America North America\n150  North America North America\n151  South America South America\n152  South America South America\n153         Africa        Africa\n154  North America North America\n155  North America North America\n156  North America North America\n157           Asia          Asia\n158  North America North America\n159  North America North America\n160  North America North America\n161  North America North America\n162  South America South America\n163  South America South America\n164  South America South America\n165  North America North America\n166           Asia South America\n167  South America South America\n168  North America North America\n169  South America South America\n170  North America North America\n171         Africa        Africa\n172  North America North America\n173           Asia          Asia\n174  North America North America\n175  South America South America\n176           Asia North America\n177  South America South America\n178  South America South America\n179  North America North America\n180  North America North America\n181  North America North America\n182  South America South America\n183  North America North America\n184  North America North America\n185  South America South America\n186  South America South America\n187  North America North America\n188  North America North America\n189  North America North America\n190         Africa        Africa\n191  South America South America\n192  North America North America\n193  North America North America\n194  South America South America\n195  North America North America\n196  South America South America\n197           Asia          Asia\n198  North America North America\n199  North America North America\n200  North America North America\n201  North America North America\n202           Asia          Asia\n203  North America North America\n204         Africa        Africa\n205  North America North America\n206  South America South America\n207  North America North America\n208  North America North America\n209           Asia          Asia\n210  North America North America\n211  North America North America\n212  North America North America\n213           Asia          Asia\n214  South America South America\n215  North America North America\n216  South America South America\n217  North America North America\n218  North America North America\n219  South America South America\n220  North America North America\n221  North America North America\n222  North America North America\n223  North America North America\n224         Africa        Africa\n225  North America North America\n226           Asia          Asia\n227  South America South America\n228  North America North America\n229           Asia          Asia\n230  North America North America\n231         Africa        Africa\n232  North America North America\n233           Asia          Asia\n234  South America South America\n235  North America North America\n236  North America North America\n237         Africa        Africa\n238  North America North America\n239  North America North America\n240  North America North America\n241  South America South America\n242           Asia          Asia\n243  North America North America\n244         Africa        Africa\n245         Africa        Africa\n246         Africa        Africa\n247  South America South America\n248  South America South America\n249  South America South America\n250  North America North America\n251  South America South America\n252  South America South America\n253  North America North America\n254  South America South America\n255         Africa        Africa\n256           Asia          Asia\n257  North America North America\n258           Asia          Asia\n259  North America North America\n260  North America North America\n261  North America North America\n262  North America North America\n263  South America South America\n264  South America South America\n265  South America North America\n266  North America North America\n267         Africa        Africa\n268  North America North America\n269  North America North America\n270  North America North America\n271  North America North America\n272         Africa        Africa\n273  South America South America\n274         Africa        Africa\n275  North America North America\n276  North America North America\n277  North America North America\n278  North America North America\n279  North America North America\n280  South America South America\n281  South America South America\n282  South America South America\n283  North America North America\n284           Asia          Asia\n285  North America North America\n286           Asia          Asia\n287  South America South America\n288  North America North America\n289  South America South America\n290  North America North America\n291  South America South America\n292  South America South America\n293  North America North America\n294           Asia          Asia\n295         Africa        Africa\n296  South America South America\n297  South America South America\n298  North America North America\n299  North America North America\n300  South America South America\n301  North America North America\n302  North America North America\n303  South America South America\n304  North America North America\n305  South America South America\n306  South America South America\n307           Asia          Asia\n308         Africa        Africa\n309  North America North America\n310  North America North America\n311           Asia          Asia\n312  South America South America\n313  North America North America\n314           Asia          Asia\n315           Asia          Asia\n316  North America North America\n317  North America North America\n318  North America North America\n319  North America North America\n320         Africa        Africa\n321  North America North America\n322  South America South America\n323  South America South America\n324           Asia          Asia\n325  South America South America\n326  North America North America\n327  North America North America\n328  North America North America\n329         Africa        Africa\n330  North America North America\n331         Africa        Africa\n332  North America North America\n333  North America North America\n334  South America South America\n335  South America South America\n336  North America North America\n337  North America North America\n338         Africa        Africa\n339  North America North America\n340  North America North America\n341  North America North America\n342  North America North America\n343  North America North America\n344           Asia          Asia\n345         Africa        Africa\n346  North America North America\n347  South America South America\n348  South America South America\n349  South America South America\n350  South America South America\n351  North America North America\n352  North America North America\n353         Africa        Africa\n354  South America South America\n355  North America North America\n356  North America North America\n357  South America South America\n358         Africa        Africa\n359         Africa        Africa\n360  North America North America\n361  North America North America\n362  South America South America\n363  North America North America\n364  North America North America\n365           Asia          Asia\n366         Africa        Africa\n367  North America North America\n368  South America South America\n369  North America North America\n370  North America North America\n371         Africa        Africa\n372  North America North America\n373  South America South America\n374           Asia          Asia\n375  North America North America\n376  South America South America\n377  North America North America\n378  North America North America\n379  South America South America\n380  North America North America\n381         Africa        Africa\n382  North America North America\n383           Asia          Asia\n384  South America South America\n385  North America North America\n386         Africa        Africa\n387  North America North America\n388  South America South America\n389  North America North America\n390  South America South America\n391  North America North America\n392  South America South America\n393  South America South America\n394  North America North America\n395  North America North America\n396  South America South America\n397  South America South America\n398         Africa        Africa\n399  North America North America\n400  North America North America\n401  North America North America\n402  North America North America\n403           Asia          Asia\n404  North America North America\n405           Asia          Asia\n406           Asia          Asia\n407  South America South America\n408  North America North America\n409  South America South America\n410           Asia          Asia\n411  North America North America\n412  North America North America\n413  South America South America\n414         Africa        Africa\n415  South America South America\n416  South America South America\n417           Asia          Asia\n418         Africa        Africa\n419         Africa        Africa\n420  North America North America\n421           Asia          Asia\n422  North America North America\n423  North America North America\n424  North America North America\n425  North America        Africa\n426  North America North America\n427  North America North America\n428  North America North America\n429           Asia          Asia\n430  North America North America\n431  North America North America\n432         Africa        Africa\n433  South America South America\n434  North America North America\n435           Asia          Asia\n436           Asia          Asia\n437  South America South America\n438  South America South America\n439  North America North America\n440  North America North America\n441  North America North America\n442           Asia          Asia\n443  North America North America\n444  South America South America\n445  South America South America\n446           Asia          Asia\n447  North America North America\n448  North America North America\n449  North America North America\n450  South America South America\n451  North America North America\n452         Africa        Africa\n453  South America South America\n454  North America North America\n455  North America North America\n456           Asia          Asia\n457  North America North America\n458  North America North America\n459  North America North America\n460  North America North America\n461  North America North America\n462           Asia          Asia\n463  North America North America\n464  South America South America\n465           Asia          Asia\n466  North America North America\n467           Asia          Asia\n468           Asia          Asia\n469         Africa        Africa\n470  North America North America\n471           Asia          Asia\n472  South America South America\n473         Africa        Africa\n474         Africa        Africa\n475  North America South America\n476  North America North America\n477         Africa        Africa\n478  North America North America\n479           Asia          Asia\n480  North America North America\n481         Africa        Africa\n482  North America North America\n483  North America North America\n484  North America North America\n485  South America South America\n486  South America South America\n487  North America North America\n488  North America North America\n489  South America South America\n490         Africa        Africa\n491  North America North America\n492  South America South America\n493  North America North America\n494  North America North America\n495  South America North America\n496  North America North America\n497  South America South America\n498  North America North America\n499           Asia          Asia\n500  South America South America\n501  North America North America\n502         Africa        Africa\n503         Africa        Africa\n504  South America South America\n505  South America South America\n506           Asia          Asia\n507  North America North America\n508  North America North America\n509         Africa        Africa\n510  South America South America\n511  North America North America\n512  South America South America\n513         Africa        Africa\n514  South America South America\n515         Africa        Africa\n516         Africa        Africa\n517  North America North America\n518  South America South America\n519  South America South America\n520  North America North America\n521  South America South America\n522         Africa        Africa\n523  South America South America\n524  South America South America\n525           Asia          Asia\n526  North America North America\n527  South America South America\n528  North America North America\n529  South America South America\n530  North America North America\n531  North America North America\n532  North America North America\n533  North America North America\n534  North America North America\n535  South America South America\n536           Asia          Asia\n537           Asia          Asia\n538           Asia          Asia\n539  North America North America\n540  South America South America\n541  South America South America\n542           Asia          Asia\n543  North America North America\n544  North America North America\n545  South America South America\n546  North America North America\n547  North America North America\n548  North America North America\n549  North America North America\n550  South America South America\n551         Africa        Africa\n552  North America North America\n553  North America North America\n554         Africa        Africa\n555  North America North America\n556  South America South America\n557  South America South America\n558  South America South America\n559  North America North America\n560  South America South America\n561  North America North America\n562  South America South America\n563  South America South America\n564  North America North America\n565  North America North America\n566  North America North America\n567  North America North America\n568  North America North America\n569  South America South America\n570  North America North America\n571  North America North America\n572  North America North America\n573  North America North America\n574  North America North America\n575  North America North America\n576  North America North America\n577           Asia          Asia\n578  North America North America\n579           Asia          Asia\n580         Africa        Africa\n581         Africa        Africa\n582  North America North America\n583  North America North America\n584  North America North America\n585           Asia          Asia\n586  North America North America\n587         Africa        Africa\n588  South America South America\n589         Africa        Africa\n590  North America North America\n591  North America North America\n592  South America South America\n593  North America North America\n594  North America North America\n595  North America North America\n596  North America North America\n597  South America South America\n598  North America North America\n599  North America North America\n600  North America North America\n601  North America North America\n602  South America North America\n603  South America South America\n604           Asia          Asia\n605  North America North America\n606  North America North America\n607  North America North America\n608  North America North America\n609  South America South America\n610  North America North America\n611  North America North America\n612  South America South America\n613  North America North America\n614           Asia          Asia\n615         Africa        Africa\n616           Asia          Asia\n617  South America South America\n618           Asia          Asia\n619  North America North America\n620  North America North America\n621  North America North America\n622  North America North America\n623  South America South America\n624           Asia          Asia\n625  North America North America\n626  North America North America\n627  North America North America\n628  North America North America\n629  North America North America\n630           Asia          Asia\n631  South America South America\n632  South America South America\n633           Asia          Asia\n634  South America South America\n635  South America South America\n636           Asia          Asia\n637  North America North America\n638           Asia          Asia\n639  South America South America\n640  South America South America\n641  South America South America\n642  South America South America\n643  North America North America\n644  South America South America\n645         Africa        Africa\n646  South America South America\n647  South America South America\n648           Asia          Asia\n649  South America North America\n650         Africa        Africa\n651  South America South America\n652         Africa        Africa\n653         Africa        Africa\n654  North America North America\n655  South America South America\n656  North America North America\n657  North America North America\n658  North America North America\n659  South America South America\n660           Asia          Asia\n661  North America North America\n662  South America South America\n663         Africa        Africa\n664           Asia          Asia\n665  South America South America\n666  South America South America\n667         Africa        Africa\n668  North America North America\n669  North America North America\n670  North America North America\n671  North America North America\n672           Asia          Asia\n673  South America South America\n674  South America South America\n675  South America South America\n676  North America North America\n677           Asia          Asia\n678  North America North America\n679  North America North America\n680  South America South America\n681           Asia          Asia\n682  North America North America\n683  North America North America\n684  South America South America\n685  South America South America\n686  North America North America\n687  North America North America\n688  North America North America\n689  North America North America\n690         Africa        Africa\n691  South America South America\n692  North America North America\n693  North America North America\n694         Africa        Africa\n695  South America South America\n696  South America South America\n697  North America North America\n698  South America South America\n699  South America South America\n700         Africa        Africa\n701  North America North America\n702  North America North America\n703  North America North America\n704         Africa        Africa\n705         Africa        Africa\n706  South America South America\n707           Asia          Asia\n708  North America North America\n709  North America North America\n710         Africa        Africa\n711  North America North America\n712           Asia          Asia\n713  South America South America\n714  North America North America\n715  South America South America\n716  North America North America\n717  North America North America\n718           Asia          Asia\n719  South America South America\n720           Asia          Asia\n721  North America North America\n722         Africa        Africa\n723  North America North America\n724  South America South America\n725         Africa        Africa\n726  North America North America\n727  North America North America\n728           Asia          Asia\n729         Africa        Africa\n730  South America South America\n731  North America North America\n732  North America North America\n733         Africa        Africa\n734  North America North America\n735           Asia          Asia\n736         Africa        Africa\n737  North America North America\n738  North America North America\n739  North America North America\n740  North America North America\n741  North America North America\n742  South America South America\n743  South America South America\n744  South America South America\n745         Africa        Africa\n746  North America North America\n747  South America South America\n748  South America South America\n749  South America South America\n750  North America North America\n751  North America North America\n752         Africa        Africa\n753  North America North America\n754  North America North America\n755         Africa        Africa\n756  North America North America\n757  South America South America\n758  North America North America\n759           Asia          Asia\n760  North America North America\n761  South America South America\n762           Asia          Asia\n763  North America North America\n764  South America South America\n765  North America North America\n766  North America North America\n767  North America North America\n768  North America North America\n769  North America North America\n770         Africa        Africa\n771           Asia          Asia\n772  South America South America\n773         Africa        Africa\n774  North America North America\n775  North America North America\n776  North America North America\n777  North America North America\n778  South America South America\n779  South America South America\n780  North America North America\n781  South America South America\n782  North America North America\n783  North America North America\n784           Asia          Asia\n785  South America South America\n786  North America North America\n787  North America North America\n788  South America South America\n789         Africa        Africa\n790         Africa        Africa\n791  South America South America\n792  North America North America\n793  North America North America\n794  North America North America\n795  North America North America\n796  North America North America\n797           Asia          Asia\n798  North America North America\n799         Africa        Africa\n800         Africa        Africa\n801         Africa        Africa\n802         Africa        Africa\n803  North America North America\n804         Africa        Africa\n805         Africa        Africa\n806         Africa        Africa\n807  North America North America\n808  North America North America\n809  North America North America\n810  North America North America\n811  North America North America\n812  North America North America\n813         Africa        Africa\n814  South America South America\n815         Africa        Africa\n816           Asia          Asia\n817  North America North America\n818  South America North America\n819  South America South America\n820           Asia          Asia\n821  North America North America\n822           Asia          Asia\n823  South America South America\n824  South America South America\n825  North America North America\n826  South America South America\n827         Africa        Africa\n828  North America North America\n829  South America South America\n830  North America North America\n831         Africa        Africa\n832  North America North America\n833  North America North America\n834  South America South America\n835         Africa        Africa\n836         Africa        Africa\n837  North America North America\n838  North America North America\n839  North America North America\n840  North America North America\n841  North America North America\n842  North America North America\n843  North America North America\n844  North America North America\n845  North America North America\n846  North America North America\n847           Asia North America\n848  North America North America\n849  North America North America\n850  North America North America\n851  North America North America\n852  North America North America\n853  North America North America\n854         Africa        Africa\n855  North America North America\n856  South America South America\n857  South America South America\n858  North America North America\n859  North America North America\n860  South America South America\n861  North America North America\n862  North America North America\n863  North America North America\n864  North America North America\n865  North America North America\n866         Africa        Africa\n867  South America South America\n868         Africa        Africa\n869  North America North America\n870  South America South America\n871  South America South America\n872           Asia          Asia\n873  South America South America\n874  North America North America\n875  South America South America\n876  South America South America\n877  South America South America\n878  North America North America\n879  North America North America\n880  South America South America\n881  North America North America\n882  South America South America\n883         Africa        Africa\n884  North America North America\n885           Asia          Asia\n886  South America South America\n887  North America North America\n888  South America South America\n889           Asia          Asia\n890  North America North America\n891           Asia          Asia\n892           Asia          Asia\n893  North America North America\n894  North America North America\n895           Asia          Asia\n896  South America South America\n897  North America North America\n898  North America North America\n899  North America North America\n900  North America North America\n901  North America North America\n902           Asia          Asia\n903  South America South America\n904  South America South America\n905  South America North America\n906  North America North America\n907           Asia          Asia\n908  South America South America\n909  North America North America\n910  North America North America\n911  South America South America\n912  North America North America\n913  South America South America\n914  North America North America\n915         Africa        Africa\n916  South America South America\n917           Asia          Asia\n918  South America South America\n919           Asia          Asia\n920           Asia          Asia\n921         Africa        Africa\n922  North America North America\n923  North America North America\n924  North America North America\n925         Africa        Africa\n926  North America North America\n927           Asia          Asia\n928  North America North America\n929  North America North America\n930  North America North America\n931  South America South America\n932  North America North America\n933  North America North America\n934  North America North America\n935  North America North America\n936         Africa        Africa\n937  North America North America\n938  North America North America\n939  North America North America\n940  South America South America\n941           Asia          Asia\n942  North America North America\n943  North America North America\n944         Africa        Africa\n945  South America South America\n946  South America South America\n947  North America North America\n948  North America North America\n949  North America North America\n950  South America South America\n951           Asia          Asia\n952  North America North America\n953  North America North America\n954  North America North America\n955  North America North America\n956  South America South America\n957  South America South America\n958  North America North America\n959  North America North America\n960           Asia          Asia\n961         Africa        Africa\n962  North America North America\n963  North America North America\n964         Africa        Africa\n965  North America North America\n966         Africa        Africa\n967  North America North America\n968           Asia          Asia\n969  North America North America\n970  North America North America\n971           Asia          Asia\n972         Africa        Africa\n973  North America North America\n974  North America North America\n975  South America South America\n976  North America North America\n977  North America North America\n978  South America South America\n979  North America North America\n980           Asia          Asia\n981  North America North America\n982  North America North America\n983  North America North America\n984  North America North America\n985  South America South America\n986  North America North America\n987         Africa        Africa\n988  North America          Asia\n989  North America North America\n990  North America North America\n991         Africa        Africa\n992           Asia          Asia\n993  South America South America\n994  South America South America\n995           Asia          Asia\n996           Asia          Asia\n997           Asia          Asia\n998  South America South America\n999         Africa        Africa\n1000          Asia          Asia\n1001 North America North America\n1002 North America North America\n1003 North America North America\n1004 South America South America\n1005 South America South America\n1006 North America North America\n1007 North America North America\n1008 North America North America\n1009 North America North America\n1010 North America North America\n1011 North America North America\n1012 North America North America\n1013 North America North America\n1014 North America North America\n1015          Asia          Asia\n1016 North America North America\n1017        Africa        Africa\n1018 North America North America\n1019 North America North America\n1020 South America South America\n1021 North America North America\n1022 South America South America\n1023          Asia          Asia\n1024 North America North America\n1025 South America South America\n1026          Asia          Asia\n1027 North America North America\n1028          Asia          Asia\n1029 South America South America\n1030 South America South America\n1031        Africa        Africa\n1032 North America North America\n1033 North America North America\n1034 North America North America\n1035 South America South America\n1036 North America North America\n1037 South America South America\n1038 South America South America\n1039 North America North America\n1040 South America South America\n1041 North America North America\n1042        Africa        Africa\n1043 North America North America\n1044 North America North America\n1045 North America North America\n1046        Africa        Africa\n1047 North America North America\n1048 South America South America\n1049 North America North America\n1050 North America North America\n1051 North America North America\n1052          Asia          Asia\n1053 North America North America\n1054          Asia          Asia\n1055 South America South America\n1056 North America North America\n1057          Asia          Asia\n1058 South America South America\n1059          Asia          Asia\n1060          Asia          Asia\n1061 South America South America\n1062 South America South America\n1063 North America North America\n1064          Asia          Asia\n1065        Africa        Africa\n1066 North America North America\n1067 North America North America\n1068 South America South America\n1069 North America North America\n```\n\n\n:::\n\n```{.r .cell-code}\npred_forest_test <- test %>%\n  select(continent) %>%\n  bind_cols(\n    predict(mod_forest, new_data = test, type = \"class\")\n  ) \npred_forest_test\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        continent   .pred_class\n1   South America North America\n2   South America North America\n3   South America South America\n4   South America North America\n5   South America South America\n6   South America North America\n7   South America North America\n8   South America        Africa\n9   South America        Africa\n10  South America North America\n11  South America North America\n12  South America North America\n13  South America North America\n14  South America North America\n15  South America        Africa\n16  South America North America\n17  South America South America\n18  South America North America\n19  South America South America\n20  South America South America\n21  South America North America\n22  South America North America\n23  South America          Asia\n24  South America          Asia\n25  South America North America\n26  South America South America\n27  South America North America\n28  South America North America\n29  South America South America\n30         Africa South America\n31           Asia North America\n32           Asia North America\n33           Asia North America\n34           Asia North America\n35           Asia South America\n36           Asia North America\n37  South America North America\n38  South America North America\n39  South America North America\n40  South America North America\n41  South America South America\n42  South America          Asia\n43  South America North America\n44  South America North America\n45  South America North America\n46  South America        Africa\n47  South America        Africa\n48  South America        Africa\n49  South America South America\n50  South America North America\n51  South America South America\n52  South America South America\n53  South America          Asia\n54  South America        Africa\n55  South America South America\n56  South America South America\n57  South America North America\n58  South America North America\n59  South America South America\n60  South America        Africa\n61  South America          Asia\n62  South America North America\n63  South America South America\n64  South America North America\n65  South America          Asia\n66  South America North America\n67  South America North America\n68  South America        Africa\n69  North America North America\n70  North America North America\n71  North America North America\n72  North America North America\n73  North America North America\n74  North America North America\n75  North America North America\n76  North America        Africa\n77  North America          Asia\n78  North America        Africa\n79  North America North America\n80  North America          Asia\n81  North America South America\n82  North America        Africa\n83  North America South America\n84  North America South America\n85  North America South America\n86  South America North America\n87  North America North America\n88  North America North America\n89  North America          Asia\n90  North America North America\n91  North America        Africa\n92         Africa        Africa\n93         Africa        Africa\n94         Africa North America\n95         Africa        Africa\n96         Africa        Africa\n97         Africa        Africa\n98         Africa        Africa\n99         Africa South America\n100        Africa        Africa\n101 North America North America\n102 North America South America\n103 North America North America\n104 North America North America\n105 North America North America\n106 North America North America\n107 North America South America\n108 North America North America\n109 North America North America\n110 North America North America\n111 North America North America\n112 North America North America\n113 North America South America\n114 North America North America\n115 North America North America\n116 North America North America\n117 North America North America\n118 North America North America\n119 North America North America\n120 North America North America\n121 North America North America\n122 North America North America\n123 North America North America\n124 North America North America\n125 North America North America\n126 North America North America\n127 North America South America\n128 North America North America\n129 North America North America\n130 North America North America\n131 North America North America\n132 North America North America\n133 North America North America\n134 North America North America\n135 North America North America\n136 North America          Asia\n137 North America South America\n138 North America North America\n139 North America North America\n140 North America North America\n141 North America North America\n142 North America          Asia\n143 North America North America\n144          Asia          Asia\n145          Asia        Africa\n146          Asia          Asia\n147          Asia          Asia\n148          Asia          Asia\n149          Asia North America\n150          Asia North America\n151          Asia North America\n152          Asia South America\n153          Asia North America\n154        Africa South America\n155        Africa North America\n156        Africa South America\n157        Africa North America\n158        Africa          Asia\n159        Africa          Asia\n160        Africa North America\n161        Africa North America\n162        Africa North America\n163        Africa North America\n164        Africa South America\n165 North America North America\n166 North America North America\n167 North America North America\n168 North America South America\n169 North America North America\n170 North America North America\n171 North America North America\n172 North America          Asia\n173 North America North America\n174 North America North America\n175 North America        Africa\n176 North America North America\n177 North America North America\n178 North America North America\n179 North America        Africa\n180 North America North America\n181 North America South America\n182 North America        Africa\n183 North America North America\n184 North America        Africa\n185 North America North America\n186 North America North America\n187 North America        Africa\n188 North America North America\n189 North America North America\n190 North America North America\n191 North America North America\n192 North America North America\n193 North America North America\n194 North America South America\n195 North America North America\n196 North America North America\n197 North America North America\n198 North America South America\n199 North America North America\n200 North America        Africa\n201 North America North America\n202 North America North America\n203 North America North America\n204 North America North America\n205 North America North America\n206 North America North America\n207 North America South America\n208 North America North America\n209          Asia North America\n210 North America        Africa\n211 North America North America\n212 North America North America\n213 North America North America\n214 North America North America\n215 North America North America\n216 North America South America\n217 North America North America\n218 North America North America\n219 South America North America\n220 South America North America\n221          Asia North America\n222 North America North America\n223          Asia South America\n224          Asia North America\n225          Asia South America\n226          Asia South America\n227          Asia North America\n228          Asia North America\n229          Asia North America\n230          Asia North America\n231          Asia North America\n232          Asia North America\n233          Asia        Africa\n234          Asia          Asia\n235        Africa South America\n236        Africa North America\n237        Africa South America\n238        Africa North America\n239        Africa North America\n240          Asia North America\n241          Asia North America\n242          Asia North America\n243          Asia North America\n244          Asia North America\n245          Asia South America\n246          Asia North America\n247          Asia          Asia\n248        Africa South America\n249        Africa South America\n250        Africa        Africa\n251        Africa        Africa\n252        Africa South America\n253        Africa South America\n254 North America North America\n255 North America          Asia\n256 North America        Africa\n257 North America North America\n258 North America North America\n259 North America South America\n260 North America North America\n261 North America North America\n262 North America North America\n263 North America North America\n264 North America North America\n265 North America North America\n266 North America          Asia\n267          Asia South America\n268          Asia South America\n```\n\n\n:::\n\n```{.r .cell-code}\naccuracy(pred_forest, continent, .pred_class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric  .estimator .estimate\n  <chr>    <chr>          <dbl>\n1 accuracy multiclass     0.985\n```\n\n\n:::\n\n```{.r .cell-code}\naccuracy(pred_forest_test, continent, .pred_class)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric  .estimator .estimate\n  <chr>    <chr>          <dbl>\n1 accuracy multiclass     0.470\n```\n\n\n:::\n\n```{.r .cell-code}\nrandomForest::importance(mod_forest$fit) %>% \n  as_tibble(rownames = \"variable\") %>%\n    arrange(desc(MeanDecreaseGini))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  variable  MeanDecreaseGini\n  <chr>                <dbl>\n1 Total               254.  \n2 Aroma               148.  \n3 Acidity             138.  \n4 Flavor              125.  \n5 Sweetness            20.8 \n6 Species               7.44\n```\n\n\n:::\n:::\n",
    "supporting": [
      "pred_model_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}